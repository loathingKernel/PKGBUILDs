From bc13bd64008dc32586a0b4d41189b74a2ab27265 Mon Sep 17 00:00:00 2001
Message-Id: <bc13bd64008dc32586a0b4d41189b74a2ab27265.1523725229.git.jan.steffens@gmail.com>
In-Reply-To: <ac8faf2b14ed1c9ce518eddfc9c5098b6f9c74dd.1523725229.git.jan.steffens@gmail.com>
References: <ac8faf2b14ed1c9ce518eddfc9c5098b6f9c74dd.1523725229.git.jan.steffens@gmail.com>
From: Dylan Baker <dylan@pnwbakers.com>
Date: Wed, 4 Apr 2018 10:53:16 -0700
Subject: [PATCH 2/5] meson: Set .so version for xa like autotools does

Fixes: 0ba909f0f111824223bc38563d1a6bc73e69c2cc
       ("meson: build gallium xa state tracker")
Signed-off-by: Dylan Baker <dylan.c.baker@intel.com>
Reviewed-by: Eric Engestrom <eric.engestrom@imgtec.com>
Reviewed-by: Emil Velikov <emil.velikov@collabora.com>
---
 src/gallium/targets/xa/meson.build | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/src/gallium/targets/xa/meson.build b/src/gallium/targets/xa/meson.build
index ea6e1296da..733ef54ff8 100644
--- a/src/gallium/targets/xa/meson.build
+++ b/src/gallium/targets/xa/meson.build
@@ -30,31 +30,33 @@ if with_ld_version_script
   xa_link_depends += files('xa.sym')
 endif
 
+_xa_version = '.'.join(xa_version)
 
 libxatracker = shared_library(
   'xatracker',
   'target.c',
   c_args : c_vis_args,
   cpp_args : cpp_vis_args,
   link_args : [xa_link_args, ld_args_gc_sections],
   include_directories : [
     inc_common, inc_util, inc_gallium_winsys, inc_gallium_drivers,
   ],
   link_whole : [libxa_st],
   link_with : [
     libgalliumvl_stub, libgallium, libmesa_util, libpipe_loader_static,
     libws_null, libwsw, libswdri, libswkmsdri,
   ],
   link_depends : xa_link_depends,
   dependencies : [
     dep_thread, driver_nouveau, driver_i915, driver_svga, driver_freedreno,
   ],
+  version : _xa_version,
   install : true,
 )
 
 pkg.generate(
   name : 'xatracker',
   description : 'Xorg gallium3D acceleration library',
-  version : '.'.join(xa_version),
+  version : _xa_version,
   libraries : libxatracker,
 )
-- 
2.16.2

